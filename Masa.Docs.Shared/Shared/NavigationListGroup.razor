@using System.Text.Json
<MListGroup Group="@GenGroup(Item.Items, Item.Segment)"
            PrependIcon="@Item.Icon"
            NoAction
            AppendIcon="mdi-menu-down"
            SubGroup="SubGroup">
    <ActivatorContent>
        <MListItemContent>
            <MListItemTitle>
                @Item.Title
            </MListItemTitle>
        </MListItemContent>
    </ActivatorContent>
    <ChildContent>
        @foreach (var item in Item.Items!)
        {
            if (item.HasChildren)
            {
                <NavigationListGroup Item="@item" SubGroup />
            }
            else
            {
                <NavigationListItem Item="@item" BaseSegment="@Item.Segment" />
            }
        }
    </ChildContent>
</MListGroup>

@code {

    [Parameter]
    public NavItem Item { get; set; } = null!;

    [Parameter]
    public bool SubGroup { get; set; }

    List<string> GenGroup(List<NavItem>? items, string baseSegment)
    {
        if (items == null || !items.Any()) return new List<string>();

        var groups = new List<string>();

        foreach (var item in items)
        {
            groups.AddRange(GenGroup(item.Items, item.Segment));
            if (item.HasChildren) continue;
            groups.Add($"{baseSegment}/{item.Segment}");
        }

        return groups;
    }

}
